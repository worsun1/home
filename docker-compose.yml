version: '3.8'

services:
  # Home service
  home-service:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: home-service
    ports:
      - "8888:8888"
    environment:
      - QUERY_CLIENT_HTTP_BASE_URL=http://query-service:8081
      - QUERY_CLIENT_GRPC_HOST=query-service
      - QUERY_CLIENT_GRPC_PORT=9092
      - DUBBO_REGISTRY_ADDRESS=zookeeper://zookeeper:2181
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8888/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3
